var THREEx=THREEx||{};THREEx.CubeCamera=function(e,t){t=t||1024;var i=new THREE.CubeCamera(.001,1e3,t);i.position=e.position,this.camera=i,this.object3d=i,this.textureCube=i.renderTarget,i.renderTarget.minFilter=THREE.LinearMipMapLinearFilter,this.update=function(t,a){e.visible=!1,i.updateCubeMap(t,a),e.visible=!0}},THREEx.CubeCamera.toImages=function(e,t,i){console.assert(e instanceof THREE.CubeCamera),i=i||e.renderTarget.width;var a=new THREE.Scene,r=THREE.ShaderLib.cube,n=THREE.UniformsUtils.clone(r.uniforms),d=new THREE.ShaderMaterial({fragmentShader:r.fragmentShader,vertexShader:r.vertexShader,uniforms:n,depthWrite:!1,side:THREE.BackSide});n.tCube.value=e.renderTarget;var E=new THREE.BoxGeometry(500,500,500),h=new THREE.Mesh(E,d);a.add(h);var o={width:t.domElement.width,height:t.domElement.height,devicePixelRatio:t.devicePixelRatio};t.setSize(i,i),t.devicePixelRatio=1;var m=[];return e.children.slice().forEach(function(e){t.render(a,e);var i=document.createElement("canvas");i.width=t.domElement.width,i.height=t.domElement.height;var r=i.getContext("2d");r.translate(0,i.height),r.scale(1,-1),r.drawImage(t.domElement,0,0),m.push(i)}),t.devicePixelRatio=o.devicePixelRatio,t.setSize(o.width,o.height),m};